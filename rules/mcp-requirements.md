## MCP-возможности для разработки 1С

Этот файл определяет контракт MCP-зависимостей для всех агентов. Агенты ссылаются на **категории возможностей** и ищут подходящие tools среди доступных MCP-серверов. Не привязывайся к конкретным именам tools — MCP-серверы могут обновляться, переименовывать tools или заменяться другими серверами. Но ты **обязан** активно искать и использовать tools, которые решают описанные ниже задачи.

### Протокол проверки доступности

Перед началом работы с кодом 1С агент должен убедиться, что обязательные MCP-серверы доступны. Для проверки достаточно вызвать любой базовый tool сервера (например, получить список проектов). Если вызов завершается ошибкой — сервер недоступен.

### Категории возможностей

#### 1. Навигация по метаданным (обязательная)

Возможности для работы с объектами конфигурации 1С:

- **Список объектов метаданных** — получить все справочники, документы, регистры, обработки, отчеты и т.д. из конфигурации. Используй для обзора структуры конфигурации и поиска нужных объектов
- **Детали объекта метаданных** — получить реквизиты, табличные части, формы, макеты конкретного объекта. Используй для понимания структуры данных при написании запросов и кода
- **Поиск ссылок на объект** — найти все места использования объекта метаданных (в коде BSL, формах, ролях, других объектах). Используй для анализа зависимостей и влияния изменений
- **Теги и группировки** — получить теги проекта и объекты по тегам. Используй для понимания логической структуры конфигурации

**Когда использовать**: при поиске существующих объектов, анализе структуры данных, проверке реквизитов перед написанием запросов, поиске зависимостей.

#### 2. Анализ кода BSL (обязательная)

Возможности для работы с исходным кодом модулей 1С:

- **Список модулей** — получить все BSL-модули проекта с указанием типа модуля и родительского объекта. Используй для обзора кодовой базы
- **Структура модуля** — получить список процедур/функций модуля с сигнатурами, параметрами, областями. Используй ВМЕСТО чтения всего файла, когда нужно понять API модуля
- **Чтение исходного кода** — прочитать модуль целиком или диапазон строк. Используй для детального изучения конкретного кода
- **Чтение конкретного метода** — прочитать одну процедуру/функцию по имени. Используй ВМЕСТО чтения всего файла, когда нужен конкретный метод
- **Поиск по коду** — полнотекстовый/regex поиск по всем BSL-модулям. Используй для поиска паттернов, вызовов, строковых литералов
- **Иерархия вызовов** — найти кто вызывает метод (callers) или что метод вызывает (callees). Используй для трассировки потоков выполнения и анализа зависимостей

**Когда использовать**: ВСЕГДА при работе с кодом 1С. Предпочитай MCP-tools чтению файлов через bash/cat. Структура модуля и чтение метода экономят контекст — не читай весь файл, если нужна одна функция.

#### 3. Валидация (обязательная)

Возможности для проверки корректности кода:

- **Валидация запросов** — проверить текст запроса 1С на синтаксические и семантические ошибки в контексте проекта (включая режим СКД). Используй ОБЯЗАТЕЛЬНО после написания или изменения каждого запроса
- **Ошибки проекта** — получить список проблем проекта с фильтрацией по серьезности, проверке, объектам. Используй для проверки написанного кода
- **Перевалидация объектов** — запустить повторную проверку конкретных объектов. Используй после внесения изменений в объект

**Когда использовать**: после написания или изменения запросов — ВСЕГДА валидируй. После написания кода — проверяй ошибки проекта.

#### 4. Справка платформы (обязательная)

Возможности для получения информации о платформе 1С:

- **Автодополнение и подсказки** — получить предложения автодополнения (типы, методы, свойства) в контексте кода. Используй для проверки существования методов и получения сигнатур
- **Документация платформы** — получить документацию по типам платформы (методы, свойства, конструкторы). Используй для проверки API платформы и правильности вызовов

**Когда использовать**: при сомнениях в существовании метода, свойства или типа платформы. При проверке правильности сигнатуры вызова. При проверке имен переменных на конфликт с глобальным контекстом.

#### 5. Управление проектом (опциональная)

Возможности для работы с проектом EDT:

- **Свойства конфигурации** — получить свойства конфигурации 1С (версия, режим совместимости и т.д.)
- **Закладки и задачи** — получить закладки и TODO/FIXME маркеры
- **Описания проверок** — получить документацию по проверкам EDT

#### 6. Отладка и запуск (расширяемая, пока ограничено)

Возможности для запуска и отладки конфигурации:

- **Список приложений** — получить список информационных баз проекта
- **Обновление базы данных** — обновить информационную базу (полное или инкрементальное обновление)
- **Запуск в режиме отладки** — запустить приложение с автообновлением базы
- **Скриншот формы** — получить снимок формы из редактора WYSIWYG

**Статус**: эти возможности могут быть доступны. Если доступны — используй. Если нет — работай без них.

### Правила для агентов

1. **Активно используй MCP** — не ограничивайся одним tool. EDT MCP Server предоставляет множество возможностей: навигацию, анализ кода, валидацию, справку. Используй ВСЕ подходящие tools для задачи, а не только базовые.

2. **Предпочитай MCP чтению файлов** — если нужно понять структуру модуля, используй MCP (структура модуля, чтение метода) вместо чтения файла через bash. Это точнее и эффективнее.

3. **Валидируй через MCP** — после написания запросов и кода ОБЯЗАТЕЛЬНО проверяй через MCP. Не полагайся на свое знание синтаксиса.

4. **Обязательный = стоп при отсутствии** — если обязательная возможность недоступна (нет ни одного MCP-сервера с этой возможностью), уведоми пользователя и останови работу.

5. **Сообщай о недоступности** — если обязательный MCP недоступен, укажи пользователю какой именно сервер нужен и дай ссылку на установку (см. секцию «Известные MCP-серверы»).

6. **Адаптируйся к новым tools** — если в окружении появился новый MCP-tool, подходящий для задачи, используй его. Не ограничивайся заранее известным набором.

### Известные MCP-серверы

| Сервер | Категории | Ссылка |
|--------|-----------|--------|
| EDT MCP Server | Навигация по метаданным, Анализ кода BSL, Валидация, Управление проектом, Отладка и запуск | [DitriXNew/EDT-MCP](https://github.com/DitriXNew/EDT-MCP) |
| mcp-bsl-platform-context | Справка платформы | [alkoleft/mcp-bsl-platform-context](https://github.com/alkoleft/mcp-bsl-platform-context) |
